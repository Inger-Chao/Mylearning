## 寄存器

**CPU中的器件**

- *运算器*：信息处理
- *寄存器*：信息存储
- *控制器*：控制各种器件进行工作
- *内部总线*：连接各种器件，进行数据的传送

### 通用寄存器：AX/BX/CX/DX

8086CPU的所有寄存器都是16位，可存放两个字节。XX可分为高八位为XH,低八位为XL。

- *AX(Accumulator)* ：累加器。I/O、乘除运算
- *BX(Base)*：基址寄存器。提供存储器地址
- CX(Counter)计数器
- DX(Data)数据寄存器：暂存数据，输入输出时，提供I/O地址

`在进行数据传送或运算时，指令的两个操作对象的位数应当是一致的`

**物理地址**：内存单元在内存中的唯一的地址。

***16位CPU的含义***

- 运算器一次最多可以处理16位数据
- 寄存器最大宽度为16位
- 寄存器与运算器之间的通路为16位

***8086CPU给出20位物理地址的方法***

1. CPU中的相关部件提供两个16位的地址，一个称为**段地址**，另一个称为**偏移地址**
2. 段地址和偏移地址通过内部总线送入地址加法器
3. 地址加法器中**物理地址=段地址×16+偏移地址**
4. 地址加法器把物理地址送到**I/O控制电路**，IO控制电路再送到**地址总线**，地址总线再送到**存储器**

***段的概念***：地址连续的内存单元。段地址×16为起始地址，偏移地址定义段中的内存单元。

`段的起始地址一定是16的倍数` 偏移地址为16，16位寻址能力为64KB，所以`段的长度最大为64KB`。

### 指针寄存器：SP/BP/SI/DI

- *SP*：堆栈指针寄存器。
  - 入栈：`数->(SP);SP<--SP-2`
  - 出栈：`(SP)->   ;SP<-SP+2`
- *BP*：基址指针。
- *SI/DI*：变址指针。

### 标志寄存器(PSW/FLAGS)

- 记录运算结果
  - 无符号数运算
    - *ZF*：零标志。ZF=1，运算结果为0
    - *CF*：进/借位标志。
    - *AF*：辅助进位标志。低四位向第五位的进位(BCD调整时使用)。
    - *PF*：奇偶标志。低八位中1的个数为偶数 PF=1。`偶奇校验`
  - 带符号数运算
    - SF：符号。SF<-最高位，SF=1为负。
    - OF：溢出标志。OF=1，运算结果是否正确？
- 控制
  - *DF*：方向标志。串操作时有用。
    - DF=0：地址指针递增
    - DF=1：地址指针递减
  - *IF*：可屏蔽终端允许标志。
  - TF：陷阱标志。TF=1，只执行一条，中断，执行陷阱程序。用于调试程序。

### 段寄存器：CS/DS/SS/ES

- *CS*：代码段寄存器。正在运行的程序段首地址
- *DS*：数据段寄存器。正在访问的数据段首地址
- *SS*：堆栈段寄存器。`堆栈：SS:SP(BP)`
- *ES*：附加段寄存器。`串目标：ES:DI`

### ***CS和IP***：指示CPU当前要读取指令的地址

***8086读取执行一条指令的过程***

1. CS、IP中的内容送入**地址加法器**，地址加法器完成物理地址=CS×16+IP
2. 地址加法器把物理地址送入**输入输出控制电路**
3. 输入输出控制电路把物理地址送到**AB**
4. 从该物理地址单元开始存放的机器指令通过**DB**被送入**CPU**
5. 输入输出控制电路将机器指令送入**指令缓冲器**
6. IP的值**自动增加**读入指令的长度。转到步骤1 。

*修改CS、IP的值*：强制跳转指令。`jmp 段地址：偏移地址`

*代码段*：长度为N(N<=64KB)的一组代码，存放在一组地址连续、起始地址为16的倍数的内存单元中。执行代码段时，CS:IP指向代码段中的第一条指令的首地址。
